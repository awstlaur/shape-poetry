<html>
<head>	
	<script type="text/javascript" src="js/canvg/rgbcolor.js"></script> 
	<script type="text/javascript" src="js/canvg/StackBlur.js"></script>
	<script type="text/javascript" src="js/canvg/canvg.js"></script>
	<script type="text/javascript" src="js/camanjs/dist/caman.full.min.js"></script>
	<script type="text/javascript" src="js/image-processing.js"></script>
	<script type="text/javascript">
	function onLoad() {
		/**filter seize takes threshold value (0-255)
			and converts image to b/w:
			for each pixel, pixel white if above threshold,
				(or if already white)
			pixel black if below or equal threshold*/
		Caman.Filter.register('seive', function(threshold){
			var white = 255;
			var black = 0;
			this.process('seive', function(rgba){
				var bright = brightness(rgba);
				// console.log(rgba);
				// console.log('bright', bright);
				if(bright > threshold || bright == 255){
					rgba.r = white;
					rgba.g = white;
					rgba.b = white;
				}else{
					rgba.r = black;
					rgba.g = black;
					rgba.b = black;
				}
				return rgba;
			});
		});
		//load svg into a canvas		
		canvg('phantomCanvas', 'svg-files/shapes1.svg');
		//capture data url
		var phantomCanvas = document.getElementById('phantomCanvas');
		var img = phantomCanvas.toDataURL('image/png');

		Caman('#canvas', img, function(){
			//this.seive(0);
			this.render();
		});
	}
	</script>
</head>
<body onload="onLoad()">
	<canvas id="phantomCanvas" style="display:none"></canvas>
	<canvas id="canvas"></canvas>

</body>
</html>